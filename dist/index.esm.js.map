{
  "version": 3,
  "sources": ["../src/components/Map.tsx", "../src/services/ApiLoader.ts", "../src/services/Api.ts"],
  "sourcesContent": ["import React, { FunctionComponent, HTMLAttributes, useEffect, useRef } from 'react';\nimport Api, { MapConfig } from '../services/Api';\n\ninterface MapProps extends HTMLAttributes<HTMLDivElement>, MapConfig {}\n\nconst Map: FunctionComponent<MapProps> = ({ center, zoom, defaultLayer, sync, controls, markers, apiConfig, ...rest }) => {\n\tconst map = useRef<any>(null);\n  const ref = useRef<HTMLDivElement>(null);\n\n\tuseEffect(() => {\n\t\tif (ref.current) {\n      Api.loadMapIntoContainer(ref.current, {\n        center,\n        zoom,\n        defaultLayer,\n        sync,\n        controls,\n        markers,\n        apiConfig,\n      }).then((newMap: any) => map.current = newMap);\n\t\t}\n\t}, [ref.current]);\n\n\treturn <div ref={ref} {...rest} />;\n};\n\nexport default Map;\n", "export type ApiVariantType = 'full' | 'simple';\n\nexport type ApiConfig = {\n\tkey?: string;\n\tjak?: boolean;\n\tpoi?: boolean;\n\tpano?: boolean;\n\tsuggest?: boolean;\n\tapi?: ApiVariantType;\n};\n\nenum Status {\n\tIDLE,\n\tLOADING,\n\tREADY,\n\tERROR,\n}\n\nconst defaultApiConfig = {\n\tjak: true,\n\tpoi: false,\n\tpano: false,\n\tsuggest: false,\n\tapi: 'full',\n};\n\nclass ApiLoader {\n\tprivate static status = Status.IDLE;\n\n\tprivate static loadingPromise: Promise<void> | null = null;\n\n\tprivate static appendScript() {\n\t\treturn new Promise<void>((resolve, reject) => {\n\t\t\tconst el = document.createElement('script');\n\n\t\t\tel.type = 'text/javascript';\n\t\t\tel.src = 'https://api.mapy.cz/loader.js';\n\t\t\tel.onload = () => resolve();\n\t\t\tel.onerror = e => reject(e);\n\n\t\t\tdocument.head.appendChild(el);\n\t\t});\n\t}\n\n\tprivate static async runInitialLoad({ key = '', ...config }: ApiConfig) {\n\t\treturn new Promise<void>(resolve => {\n\t\t\twindow.Loader.async = true;\n\t\t\twindow.Loader.load(key, { ...defaultApiConfig, ...config }, () => {\n\t\t\t\tresolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate static load(config: ApiConfig) {\n\t\tif (ApiLoader.loadingPromise === null) {\n\t\t\tApiLoader.loadingPromise = new Promise<void>(async (resolve, reject) => {\n\t\t\t\ttry {\n\t\t\t\t\tawait ApiLoader.appendScript();\n\t\t\t\t\tawait ApiLoader.runInitialLoad(config);\n\n\t\t\t\t\tresolve();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tApiLoader.status = Status.ERROR;\n\n\t\t\t\t\treject(e);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn ApiLoader.loadingPromise;\n\t}\n\n\tstatic async init(config: ApiConfig = {}) {\n\t\tconst { api } = config;\n\n\t\tif (ApiLoader.status === Status.READY) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn ApiLoader.load(config);\n\t}\n}\n\nexport default ApiLoader;\n", "import ApiLoader, { ApiConfig, ApiVariantType } from './ApiLoader';\n\ntype CoordsType = {\n\tlat: number;\n\tlon: number;\n};\n\ntype LayerType =\n\t| 'BASE'\n\t| 'TURIST'\n\t| 'OPHOTO'\n\t| 'HYBRID'\n\t| 'HISTORIC'\n\t| 'OPHOTO0203'\n\t| 'OPHOTO0406'\n\t| 'OBLIQUE'\n\t| 'SMART_BASE'\n\t| 'SMART_OPHOTO'\n\t| 'SMART_TURIST'\n\t| 'RELIEF'\n\t| 'PANO'\n\t| 'TURIST_WINTER'\n\t| 'SMART_WINTER'\n\t| 'SMART_SUMMER'\n\t| 'GEOGRAPHY'\n\t| 'OPHOTO1012'\n\t| 'HYBRID_SPARSE'\n\t| 'OPHOTO1415'\n\t| 'OPHOTO1618';\n\ntype ControlsType = {\n\thasDefault?: boolean;\n\tcompass?: {\n\t\ttitle?: string;\n\t\tstyle?: Record<string, string | number>;\n\t};\n\tmouse?: ('pan' | 'wheel' | 'zoom' | 'zoom-in' | 'zoom-out')[];\n\tkeyboard?: ('pan' | 'zoom')[];\n};\n\ntype MarkerType = {\n  center: CoordsType;\n  name: string;\n  options?: {\n    prefetch?: number;\n    supportsAnimation?: boolean;\n    poiTooltip?: boolean;\n  };\n};\n\nexport type MapConfig = {\n\tcenter?: CoordsType;\n\tzoom?: number;\n\tdefaultLayer?: LayerType;\n\tsync?: {\n\t\tisEnabled?: boolean;\n\t\tbottom?: number;\n\t};\n\tcontrols?: ControlsType;\n  markers?: MarkerType[];\n\tapiConfig?: ApiConfig;\n};\n\nclass Api {\n  private static markersLayers: Record<string, any> = {};\n\n\tpublic static async loadMapIntoContainer(\n\t\tcontainer: HTMLDivElement,\n\t\t{ apiConfig, ...config }: MapConfig = {}\n\t) {\n\t\tawait ApiLoader.init(apiConfig);\n\n\t\tconst {\n\t\t\tcenter = {\n\t\t\t\tlat: 50.0674706,\n\t\t\t\tlon: 14.4715394,\n\t\t\t},\n\t\t\tdefaultLayer = 'BASE',\n\t\t\tzoom = 14,\n\t\t\tsync = { isEnabled: false },\n\t\t\tcontrols,\n      markers = [],\n\t\t} = config;\n\n\t\tconst map = Api.createMap(container, Api.createCoords(center), zoom);\n\n\t\tif (apiConfig?.api !== 'simple') {\n\t\t\tif (typeof map.addDefaultLayer === 'undefined') {\n\t\t\t\tApi.logMixingAPIsError('simple');\n\t\t\t} else {\n\t\t\t\tApi.addLayer(map, defaultLayer).enable();\n\t\t\t}\n\t\t} else {\n\t\t\tif (typeof map.addDefaultLayer !== 'undefined') {\n\t\t\t\tApi.logMixingAPIsError('full');\n\t\t\t\tApi.addLayer(map, defaultLayer).enable();\n\t\t\t}\n\t\t}\n\n\t\tif (sync.isEnabled) {\n\t\t\tApi.addSync(map, sync.bottom);\n\t\t}\n\n\t\tif (controls) {\n\t\t\tApi.addControls(map, controls);\n\t\t}\n\n    if (markers) {\n      Api.addMarkers(map, markers);\n    }\n\n    return map;\n\t}\n\n\tprivate static logMixingAPIsError = (loadedVariant: ApiVariantType) => {\n\t\tconst full = 'Full';\n\t\tconst simple = 'Simple';\n\t\tconst loaded = loadedVariant === 'full' ? full : simple;\n\t\tconst wanted = loadedVariant === 'simple' ? simple : full;\n\n\t\tconsole.error(\n\t\t\t`Map should be loaded with ${wanted} API but ${loaded} API is already loaded. Mixing APIs isn\\'t supported by Mapy.cz API.`\n\t\t);\n\t\tconsole.info(`Map now uses ${loaded} API.`);\n\t};\n\n\tprivate static createCoords({ lat, lon }: CoordsType) {\n\t\treturn window.SMap.Coords.fromWGS84(lon, lat);\n\t}\n\n\tprivate static createMap(container: HTMLDivElement, center: any, zoom: number) {\n\t\treturn new window.SMap(window.JAK.gel(container), center, zoom);\n\t}\n\n\tprivate static addLayer(map: any, layer: string) {\n\t\treturn map.addDefaultLayer(window.SMap[`DEF_${layer}`]);\n\t}\n\n\tprivate static addSync(map: any, bottomMargin?: number) {\n\t\tmap.addControl(new window.SMap.Control.Sync({ bottomSpace: bottomMargin }));\n\t}\n\n\tprivate static addControls(map: any, { hasDefault, compass, mouse, keyboard }: ControlsType) {\n\t\tif (hasDefault) {\n\t\t\tmap.addDefaultControls();\n\t\t}\n\n\t\tif (compass) {\n\t\t\tmap.addControl(new window.SMap.Control.Compass({ title: compass.title }), compass.style);\n\t\t}\n\n\t\tif (mouse) {\n\t\t\tmap.addControl(\n\t\t\t\tnew window.SMap.Control.Mouse(\n\t\t\t\t\t(mouse.includes('pan') ? window.SMap.MOUSE_PAN : 0)\n          + (mouse.includes('wheel') ? window.SMap.MOUSE_WHEEL\t: 0)\n          + (mouse.includes('zoom') ? window.SMap.MOUSE_ZOOM\t: 0)\n          + (mouse.includes('zoom-in') ? window.SMap.MOUSE_ZOOM_IN\t: 0)\n          + (mouse.includes('zoom-out') ? window.SMap.MOUSE_ZOOM_OUT\t: 0)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (keyboard) {\n\t\t\tmap.addControl(\n\t\t\t\tnew window.SMap.Control.Keyboard(\n\t\t\t\t\t(keyboard.includes('pan') ? window.SMap.KB_PAN : 0)\n          + (keyboard.includes('zoom') ? window.SMap.KB_ZOOM\t: 0)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n  private static getMarkersLayer(map: any, layerName: string) {\n    if (typeof Api.markersLayers[layerName] === 'undefined') {\n      const layer = new window.SMap.Layer.Marker();\n      map.addLayer(layer);\n      layer.enable();\n\n      Api.markersLayers[layerName] = layer;\n    }\n\n    return Api.markersLayers[layerName];\n  }\n\n  private static addMarkers(map: any, markers: MarkerType[], layerName = 'default') {\n    const layer = Api.getMarkersLayer(map, layerName);\n\n    markers.forEach(({ center, name, options }) => {\n      layer.addMarker(new window.SMap.Marker(Api.createCoords(center), name, options));\n    });\n  }\n\n  public static addMarkerToLayer(map: any, { center, name, options }: MarkerType, layerName = 'default') {\n    const layer = Api.getMarkersLayer(map, layerName);\n\n    layer.addMarker(new window.SMap.Marker(Api.createCoords(center), name, options));\n  }\n}\n\nexport default Api;\n"],
  "mappings": "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",
  "names": ["React", "useEffect", "useRef", "defaultApiConfig", "_ApiLoader", "resolve", "reject", "el", "e", "key", "config", "api", "ApiLoader", "__publicField", "ApiLoader_default", "_Api", "container", "apiConfig", "config", "ApiLoader_default", "center", "defaultLayer", "zoom", "sync", "controls", "markers", "map", "lat", "lon", "layer", "bottomMargin", "hasDefault", "compass", "mouse", "keyboard", "layerName", "name", "options", "Api", "__publicField", "loadedVariant", "full", "simple", "loaded", "Api_default", "Map", "center", "zoom", "defaultLayer", "sync", "controls", "markers", "apiConfig", "rest", "map", "useRef", "ref", "useEffect", "Api_default", "newMap", "React", "Map_default"]
}
